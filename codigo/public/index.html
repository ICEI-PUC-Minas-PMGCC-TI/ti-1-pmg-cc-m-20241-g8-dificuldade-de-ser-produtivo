<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trackle</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="assets/CSS/styles.css">
  <script src="assets/db/db.json"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <div class="graficos">
    <div style="width: 300px; height: 800px;" class="graficos-esp">
      <div>
        <h1 class="titulo-do-grafico">Tarefas Diárias</h1>
        <canvas id="grafico1" style="width: 300px; height: 300px;"></canvas>
      </div>
      <div>
        <h1 class="titulo-do-grafico">Tarefas Semanais</h1>
        <canvas id="grafico2" style="width: 300px; height: 300px;"></canvas>
      </div>
    </div>
  </div>

  <script>
    let TotaldeTarefas;
    let TarefasTotaisFeitas;
    // Obter o maior ID das tarefas
    function getMaxTaskId(tasks) {
      return tasks.reduce((maxId, task) => {
        const id = parseInt(task.id, 10);
        return id > maxId ? id : maxId;
      }, 0);
    }
    // Número de tarefas principais completas
    function countCompletedTasks(tasks) {
      return tasks.reduce((count, task) => {
        return task.complete ? count + 1 : count;
      }, 0);
    }
    // Carregar db.json
    fetch('assets/db/db.json')
      .then(response => response.json())
      .then(data => {
        const tasks = data.tasks;
        TotaldeTarefas = getMaxTaskId(tasks);
        TarefasTotaisFeitas = countCompletedTasks(tasks);
        console.log('TotaldeTarefas:', TotaldeTarefas);
        console.log('TarefasTotaisFeitas:', TarefasTotaisFeitas);
        // Criar os gráficos
        const ctx = document.getElementById('grafico1').getContext('2d');
        new Chart(ctx, {
          type: 'doughnut',
          data: {
            labels: ['Feitas', 'Pendentes'],
            datasets: [{
              label: 'Tarefas',
              data: [TarefasTotaisFeitas, TotaldeTarefas - TarefasTotaisFeitas], // dados do gráfico 1
              backgroundColor: [
                'rgb(34, 190, 110)',
                'rgb(150, 150, 150)',
              ],
            }]
          },
        });
        const ctx2 = document.getElementById('grafico2');
        new Chart(ctx2, {
          type: 'doughnut',
          data: {
            /*labels: ['Pendentes', 'Feitas'],*/
            datasets: [{
              /*label: 'Tarefas',*/
              data: [TarefasTotaisFeitas, TotaldeTarefas - TarefasTotaisFeitas],//dados do gráfico 2
              backgroundColor: [
                'rgb(34, 190, 110)',
                'rgb(150, 150, 150)',
              ],
            }]
          },
        });
      });
  </script>
</body>

</html>